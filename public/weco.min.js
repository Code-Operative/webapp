"use strict";var app=angular.module("wecoApp",["config","ui.router","api"]);app.config(function($stateProvider,$urlRouterProvider,$locationProvider){$locationProvider.html5Mode(!0),$urlRouterProvider.otherwise("/"),$stateProvider.state("auth",{"abstract":!0,templateUrl:"/app/auth/auth.view.html"}).state("auth.login",{url:"/login"}).state("auth.signup",{url:"/signup"}).state("weco",{"abstract":!0,resolve:{authenticate:function(){console.log("This code is ran before any state is reached...")}},template:'<nav-bar></nav-bar><div class="full-page-nav" ui-view></div>'}).state("weco.home",{url:"/",templateUrl:"/app/home/home.view.html"}).state("weco.profile",{url:"/u",templateUrl:"/app/profile/profile.view.html"})});var app=angular.module("wecoApp");app.controller("authController",["$scope","$state","User",function(a,b,c){function d(){c.login(a.credentials).then(function(){b.go("weco.home")},function(){alert("Unable to log in!")})}function e(){c.signup(a.credentials).then(function(){b.go("weco.home")},function(){alert("Unable to sign up!")})}a.credentials={},a.user=c.data,a.isLoginForm=function(){return"auth.login"==b.current.name},a.submit=function(){a.isLoginForm()?d():e()}}]),angular.module("config",[]).constant("ENV",{name:"development",apiEndpoint:"http://api-dev.eu9ntpt33z.eu-west-1.elasticbeanstalk.com/"});var app=angular.module("wecoApp");app.directive("navBar",["User","$state",function(a,b){return{restrict:"E",replace:"true",templateUrl:"/app/nav/nav.view.html",link:function(c,d,e){c.user=a.data,c.isLoggedIn=a.isLoggedIn,c.logout=function(){a.logout().then(function(){b.go("auth.login")},function(){alert("Unable to log out!")})}}}}]);var api=angular.module("api",["ngResource"]);api.config(["$httpProvider",function(a){a.defaults.withCredentials=!0}]);var api=angular.module("api");api.factory("UserAPI",["$resource","ENV",function(a,b){var c=a(b.apiEndpoint+"user/:id",{id:"me"},{login:{method:"POST",params:{id:"login"},headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:function(a,b){var c=[];for(var d in a)c.push(encodeURIComponent(d)+"="+encodeURIComponent(a[d]));return c.join("&")}},logout:{method:"GET",params:{id:"logout"}},signup:{method:"POST",params:{id:""}}});return c}]);var app=angular.module("wecoApp");app.factory("User",["UserAPI",function(a){var b={},c={};return c=a.get(),b.data=function(){return c.data||{}},b.isLoggedIn=function(){return b.data().username||!1},b.login=function(b){return new Promise(function(d,e){a.login(b).$promise["catch"](function(a){e(a.status)}).then(function(){c=a.get(function(){d()})})})},b.logout=function(){return new Promise(function(b,d){a.logout().$promise["catch"](function(a){d(a.status)}).then(function(){c=a.get(),b()})})},b.signup=function(b){return new Promise(function(d,e){a.signup(b).$promise["catch"](function(a){e(a.status)}).then(function(){c=a.get(function(){d()})})})},b}]);