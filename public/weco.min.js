"use strict";var app=angular.module("wecoApp",["config","ui.router","api"]);app.config(function($stateProvider,$urlRouterProvider,$locationProvider){$locationProvider.html5Mode(!0),$urlRouterProvider.otherwise("/"),$stateProvider.state("auth",{"abstract":!0,templateUrl:"/app/auth/auth.view.html",controller:"authController"}).state("auth.login",{url:"/login"}).state("auth.signup",{url:"/signup"}).state("weco",{"abstract":!0,resolve:{authenticate:function(){console.log("This code is ran before any state is reached...")}},template:'<nav-bar></nav-bar><div class="full-page-nav" ui-view></div>'}).state("weco.home",{url:"/",templateUrl:"/app/home/home.view.html"}).state("weco.profile",{url:"/u/:username","abstract":!0,templateUrl:"/app/profile/profile.view.html",controller:"profileController"}).state("weco.profile.about",{url:"",templateUrl:"/app/profile/about/about.view.html"}).state("weco.profile.timeline",{templateUrl:"/app/profile/timeline/timeline.view.html"}).state("weco.profile.settings",{templateUrl:"/app/profile/settings/settings.view.html"})});var app=angular.module("wecoApp");app.controller("authController",["$scope","$state","User",function(a,b,c){function d(){c.login(a.credentials).then(function(){b.go("weco.home")},function(){alert("Unable to log in!")})}function e(){c.signup(a.credentials).then(function(){b.go("weco.home")},function(){alert("Unable to sign up!")})}a.credentials={},a.user=c.me,a.isLoginForm=function(){return"auth.login"==b.current.name},a.submit=function(){a.isLoginForm()?d():e()}}]);var app=angular.module("wecoApp");app.directive("tabs",["$state",function(a){return{restrict:"E",replace:"true",scope:{items:"&",states:"&"},templateUrl:"/app/components/tabs/tabs.view.html",link:function(b,c,d){b.isSelected=function(c){return a.current.name==b.states()[c]}}}}]),angular.module("config",[]).constant("ENV",{name:"local",apiEndpoint:"http://localhost:8080/"});var app=angular.module("wecoApp");app.directive("navBar",["User","$state",function(a,b){return{restrict:"E",replace:"true",templateUrl:"/app/nav/nav.view.html",link:function(c,d,e){c.user=a.me,c.isLoggedIn=a.isLoggedIn,c.logout=function(){a.logout().then(function(){b.go("auth.login")},function(){alert("Unable to log out!")})}}}}]);var app=angular.module("wecoApp");app.controller("profileController",["$scope","$stateParams","User",function(a,b,c){a.user={},c.get(b.username).then(function(b){a.$apply(function(){a.user=b})},function(a){console.log("Unable to get user"),console.log(a)}),a.tabItems=["about","timeline","settings"],a.tabStates=["weco.profile.about","weco.profile.timeline","weco.profile.settings"]}]);var api=angular.module("api",["ngResource"]);api.config(["$httpProvider",function(a){a.defaults.withCredentials=!0}]);var api=angular.module("api");api.factory("UserAPI",["$resource","ENV",function(a,b){var c=a(b.apiEndpoint+"user/:param",{param:"me"},{login:{method:"POST",params:{param:"login"},headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:function(a,b){var c=[];for(var d in a)c.push(encodeURIComponent(d)+"="+encodeURIComponent(a[d]));return c.join("&")}},logout:{method:"GET",params:{param:"logout"}},signup:{method:"POST",params:{param:""}}});return c}]);var app=angular.module("wecoApp");app.factory("User",["UserAPI",function(a){var b={},c={};return c=a.get(),b.me=function(){return c.data||{}},b.get=function(b){return new Promise(function(c,d){a.get({param:b}).$promise["catch"](function(a){d(a.status)}).then(function(a){c(a.data)})})},b.isLoggedIn=function(){return b.me().username||!1},b.login=function(b){return new Promise(function(d,e){a.login(b).$promise["catch"](function(a){e(a.status)}).then(function(){c=a.get(function(){d()})})})},b.logout=function(){return new Promise(function(b,d){a.logout().$promise["catch"](function(a){d(a.status)}).then(function(){c=a.get(),b()})})},b.signup=function(b){return new Promise(function(d,e){a.signup(b).$promise["catch"](function(a){e(a.status)}).then(function(){c=a.get(function(){d()})})})},b}]);